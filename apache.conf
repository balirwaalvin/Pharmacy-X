# Apache configuration for DigitalOcean App Platform
ServerName pharmacy-x.ondigitalocean.app

# Security settings
ServerTokens Prod
ServerSignature Off

# Document root
DocumentRoot /var/www/html

# Listen on port 8080 (DigitalOcean App Platform requirement)
Listen 8080

# Virtual host for port 8080
<VirtualHost *:8080>
    ServerName pharmacy-x.ondigitalocean.app
    DocumentRoot /var/www/html
    
    # Directory permissions
    <Directory /var/www/html>
        Options -Indexes +FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>
    
    # Upload directory protection
    <Directory /var/www/html/Images/PaymentSlips>
        Options -Indexes
        AllowOverride None
    </Directory>
    
    <Directory /var/www/html/Images/PrescriptionMessage>
        Options -Indexes
        AllowOverride None
    </Directory>
    
    <Directory /var/www/html/Images/PrescriptionOrders>
        Options -Indexes
        AllowOverride None
    </Directory>
    
    <Directory /var/www/html/Images/Profile_Pics>
        Options -Indexes
        AllowOverride None
    </Directory>
    
    # Error and access logs
    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost>

# PHP configuration
<FilesMatch \.php$>
    SetHandler application/x-httpd-php
</FilesMatch>

# Gzip compression
LoadModule deflate_module modules/mod_deflate.so
<Location />
    SetOutputFilter DEFLATE
    SetEnvIfNoCase Request_URI \
        \.(?:gif|jpe?g|png)$ no-gzip dont-vary
    SetEnvIfNoCase Request_URI \
        \.(?:exe|t?gz|zip|bz2|sit|rar)$ no-gzip dont-vary
</Location>
